{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 119, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Websites/https---github.com-James119-nderema-Timetable_Frontend/Components/ProgramPage/ProgramCourses.jsx"],"sourcesContent":["'use client';\r\nimport React, { useState, useEffect, useMemo } from 'react';\r\nimport { useRouter } from 'next/router';\r\nimport axios from 'axios';\r\n\r\nconst ProgramCourses = () => {\r\n  const router = useRouter();\r\n  const { programId } = router.query; // Extract programId from the URL\r\n\r\n  const [periods, setPeriods] = useState([]);\r\n  const [courses, setCourses] = useState([]);\r\n  const [selectedPeriod, setSelectedPeriod] = useState('');\r\n  const [availableCoursesSearch, setAvailableCoursesSearch] = useState('');\r\n  const [periodCoursesSearch, setPeriodCoursesSearch] = useState('');\r\n  const [periodCourses, setPeriodCourses] = useState({});\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n\r\n  // Fetch periods and courses from the API\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      setLoading(true);\r\n      try {\r\n        const [periodsResponse, coursesResponse] = await Promise.all([\r\n          axios.get('http://localhost:9921/periods'),\r\n          axios.get('http://localhost:9921/courses'),\r\n        ]);\r\n\r\n        const safePeriods = periodsResponse.data.map((period, index) => ({\r\n          ...period,\r\n          uniqueId: `period-${period.id}`,\r\n          name: period.name || `Period ${index + 1}`,\r\n        }));\r\n\r\n        const safeCourses = coursesResponse.data.map((course, index) => ({\r\n          ...course,\r\n          uniqueId: `course-${course.id}`,\r\n          courseCode: course.courseCode || `COURSE-${index + 1}`,\r\n          name: course.name || `Unnamed Course ${index + 1}`,\r\n          department: course.department || 'Unknown Department',\r\n        }));\r\n\r\n        setPeriods(safePeriods);\r\n        setCourses(safeCourses);\r\n\r\n        if (safePeriods.length > 0) {\r\n          setSelectedPeriod(safePeriods[0].uniqueId);\r\n        }\r\n      } catch (err) {\r\n        console.error('Error fetching data:', err);\r\n        setError('Failed to load data. Please try again.');\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchData();\r\n  }, []);\r\n\r\n  // Filter available courses\r\n  const filteredAvailableCourses = useMemo(() => {\r\n    const currentPeriodCourses = periodCourses[selectedPeriod] || [];\r\n    return courses.filter(\r\n      (course) =>\r\n        course.uniqueId &&\r\n        !currentPeriodCourses.some((c) => c.uniqueId === course.uniqueId) &&\r\n        course.courseCode.toLowerCase().includes(availableCoursesSearch.toLowerCase())\r\n    );\r\n  }, [availableCoursesSearch, selectedPeriod, periodCourses, courses]);\r\n\r\n  // Filter courses for the selected period\r\n  const filteredPeriodCourses = useMemo(() => {\r\n    return (periodCourses[selectedPeriod] || []).filter(\r\n      (course) =>\r\n        course.uniqueId &&\r\n        course.courseCode.toLowerCase().includes(periodCoursesSearch.toLowerCase())\r\n    );\r\n  }, [periodCoursesSearch, selectedPeriod, periodCourses]);\r\n\r\n  // Add course to the selected period\r\n  const addCourseToPeriod = (course) => {\r\n    setPeriodCourses((prev) => ({\r\n      ...prev,\r\n      [selectedPeriod]: [...(prev[selectedPeriod] || []), course],\r\n    }));\r\n  };\r\n\r\n  // Remove course from the selected period\r\n  const removeCourseFromPeriod = (courseToRemove) => {\r\n    setPeriodCourses((prev) => ({\r\n      ...prev,\r\n      [selectedPeriod]: prev[selectedPeriod]?.filter(\r\n        (course) => course.uniqueId !== courseToRemove.uniqueId\r\n      ) || [],\r\n    }));\r\n  };\r\n\r\n  // Handle submit\r\n  const handleSubmit = async () => {\r\n    try {\r\n      // Prepare the payload\r\n      const selectedCourses = periodCourses[selectedPeriod] || [];\r\n      const courseIds = selectedCourses.map((course) => course.id);\r\n\r\n      const payload = {\r\n        programId, // The program ID\r\n        periodId: selectedPeriod.replace('period-', ''), // Extract the actual period ID\r\n        courseIds, // The list of course IDs\r\n      };\r\n\r\n      console.log('Submitting data:', payload);\r\n\r\n      // Make the POST request to the backend\r\n      const response = await axios.post('http://localhost:9921/programCourses', payload);\r\n\r\n      if (response.status === 200 || response.status === 201) {\r\n        alert('Courses submitted successfully!');\r\n      } else {\r\n        alert('Failed to submit courses. Please try again.');\r\n      }\r\n\r\n      // Clear the data after successful submission\r\n      setPeriodCourses({});\r\n      setAvailableCoursesSearch('');\r\n      setPeriodCoursesSearch('');\r\n    } catch (error) {\r\n      console.error('Submission Error:', error);\r\n      alert('Failed to submit courses. Please try again.');\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return <div className=\"p-6 text-center\">Loading...</div>;\r\n  }\r\n\r\n  if (error) {\r\n    return <div className=\"p-6 text-center text-red-500\">{error}</div>;\r\n  }\r\n\r\n  return (\r\n    <div className=\"container mx-auto p-6\">\r\n      <div className=\"mb-6\">\r\n        <h1 className=\"text-2xl font-bold\">Program Courses Dashboard</h1>\r\n        <p className=\"text-gray-600\">Manage courses for each period of the program.</p>\r\n      </div>\r\n\r\n      <div className=\"mb-4\">\r\n        <label htmlFor=\"period-select\" className=\"block text-sm font-medium text-gray-700\">\r\n          Select Period\r\n        </label>\r\n        <select\r\n          id=\"period-select\"\r\n          value={selectedPeriod}\r\n          onChange={(e) => setSelectedPeriod(e.target.value)}\r\n          className=\"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm\"\r\n        >\r\n          {periods.map((period) => (\r\n            <option key={period.uniqueId} value={period.uniqueId}>\r\n              {period.name}\r\n            </option>\r\n          ))}\r\n        </select>\r\n      </div>\r\n\r\n      <div className=\"grid grid-cols-2 gap-6\">\r\n        {/* Available Courses Column */}\r\n        <div className=\"border rounded-lg shadow-md\">\r\n          <div className=\"p-4 border-b\">\r\n            <h2 className=\"text-lg font-semibold\">Available Courses</h2>\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"Search available courses\"\r\n              value={availableCoursesSearch}\r\n              onChange={(e) => setAvailableCoursesSearch(e.target.value)}\r\n              className=\"mt-2 block w-full p-2 border border-gray-300 rounded-md shadow-sm\"\r\n            />\r\n          </div>\r\n          <div className=\"h-96 overflow-y-auto p-4\">\r\n            {filteredAvailableCourses.map((course) => (\r\n              <div\r\n                key={course.uniqueId}\r\n                className=\"flex justify-between items-center p-2 border-b hover:bg-gray-100\"\r\n              >\r\n                <div>\r\n                  <p className=\"font-medium\">{course.courseCode}</p>\r\n                  <p className=\"text-sm text-gray-500\">{course.name}</p>\r\n                </div>\r\n                <button\r\n                  onClick={() => addCourseToPeriod(course)}\r\n                  className=\"text-green-600 hover:text-green-800\"\r\n                >\r\n                  Add\r\n                </button>\r\n              </div>\r\n            ))}\r\n            {filteredAvailableCourses.length === 0 && (\r\n              <p className=\"text-center text-gray-500\">No courses found</p>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Period Courses Column */}\r\n        <div className=\"border rounded-lg shadow-md\">\r\n          <div className=\"p-4 border-b\">\r\n            <h2 className=\"text-lg font-semibold\">Courses for Selected Period</h2>\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"Search added courses\"\r\n              value={periodCoursesSearch}\r\n              onChange={(e) => setPeriodCoursesSearch(e.target.value)}\r\n              className=\"mt-2 block w-full p-2 border border-gray-300 rounded-md shadow-sm\"\r\n            />\r\n          </div>\r\n          <div className=\"h-96 overflow-y-auto p-4\">\r\n            {filteredPeriodCourses.map((course) => (\r\n              <div\r\n                key={course.uniqueId}\r\n                className=\"flex justify-between items-center p-2 border-b hover:bg-gray-100\"\r\n              >\r\n                <div>\r\n                  <p className=\"font-medium\">{course.courseCode}</p>\r\n                  <p className=\"text-sm text-gray-500\">{course.name}</p>\r\n                </div>\r\n                <button\r\n                  onClick={() => removeCourseFromPeriod(course)}\r\n                  className=\"text-red-600 hover:text-red-800\"\r\n                >\r\n                  Remove\r\n                </button>\r\n              </div>\r\n            ))}\r\n            {filteredPeriodCourses.length === 0 && (\r\n              <p className=\"text-center text-gray-500\">No courses added</p>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Submit Button */}\r\n      <div className=\"mt-6 text-right\">\r\n        <button\r\n          onClick={handleSubmit}\r\n          className=\"px-4 py-2 bg-blue-600 text-white rounded-md text-sm font-medium hover:bg-blue-700\"\r\n          disabled={!periodCourses[selectedPeriod] || periodCourses[selectedPeriod].length === 0}\r\n        >\r\n          Submit\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ProgramCourses;"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 550, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 556, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Websites/https---github.com-James119-nderema-Timetable_Frontend/app/program/programcourses/%5BprogramId%5D/page.js"],"sourcesContent":["'use client';\r\nimport ProgramCourses from \"@/Components/ProgramPage/ProgramCourses\";\r\n\r\nexport default function EditProgramCourses() {\r\n  return < ProgramCourses/>;\r\n}"],"names":[],"mappings":";;;;AACA;AADA;;;AAGe,SAAS;IACtB,qBAAO,8OAAE,4IAAA,CAAA,UAAc;;;;;AACzB","debugId":null}},
    {"offset": {"line": 571, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}